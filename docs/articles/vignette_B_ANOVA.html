<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>B. Analysis of Variance â€¢ HDANOVA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="B. Analysis of Variance">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HDANOVA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/vignette_A_data.html">A. Data handling</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_B_ANOVA.html">B. Analysis of Variance</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_C_ASCA.html">C. ASCA</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_D_additional.html">D. Additional methods</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/khliland/HDANOVA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>B. Analysis of Variance</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/khliland/HDANOVA/blob/HEAD/vignettes/vignette_B_ANOVA.Rmd" class="external-link"><code>vignettes/vignette_B_ANOVA.Rmd</code></a></small>
      <div class="d-none name"><code>vignette_B_ANOVA.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Start the mixlm R package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/khliland/mixlm/" class="external-link">mixlm</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="analysis-of-variance-anova">Analysis of Variance (ANOVA)<a class="anchor" aria-label="anchor" href="#analysis-of-variance-anova"></a>
</h2>
<p>This vignette will focus on univariate ANOVA in various designs
including fixed and mixed effects, and briefly introduce multivariate
ANOVA. Models using random effects will be run through the mixlm
package.</p>
<p>The following models will be demonstrated: * Fixed effect models *
One-way ANOVA * Two-way ANOVA * Covariates in ANOVA * Fixed effect
nested ANOVA * Linear mixed models * Classical LMM * Repeated measures
LMM</p>
<div class="section level3">
<h3 id="simulated-data">Simulated data<a class="anchor" aria-label="anchor" href="#simulated-data"></a>
</h3>
<p>We will start by simulating some data to use in the examples below.
In this fictitious setup, milk yield is measured as a function of feed
type (low/high protein content), cow breed, bull identity, daughter and
age. The three first factors are crossed and balanced, while daughter is
nested under bull.</p>
<p>The yield is generated with a linear model with some noise.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  feed  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>,<span class="st">"high"</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">6</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  breed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NRF"</span>,<span class="st">"Hereford"</span>,<span class="st">"Angus"</span><span class="op">)</span>, <span class="fl">16</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  bull  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, each <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  daughter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">13</span><span class="op">:</span><span class="fl">16</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  age   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">48</span>, mean <span class="op">=</span> <span class="fl">36</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">yield</span> <span class="op">&lt;-</span> <span class="fl">150</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">10</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">feed</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">breed</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                        <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">bull</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">daughter</span>, <span class="fl">48</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                        <span class="fl">0.5</span> <span class="op">*</span> <span class="va">age</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">48</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#&gt;   feed    breed bull daughter age    yield</span></span>
<span><span class="co">#&gt; 1  low      NRF    A        a  33 5541.301</span></span>
<span><span class="co">#&gt; 2  low Hereford    A        b  35 6862.560</span></span>
<span><span class="co">#&gt; 3  low    Angus    A        c  44 6954.182</span></span>
<span><span class="co">#&gt; 4  low      NRF    A        d  36 8125.363</span></span>
<span><span class="co">#&gt; 5  low Hereford    A        a  37 7344.458</span></span>
<span><span class="co">#&gt; 6  low    Angus    A        b  45 7987.227</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fixed-effect-models">Fixed effect models<a class="anchor" aria-label="anchor" href="#fixed-effect-models"></a>
</h3>
<p>The simplest form of ANOVA is the fixed effect model. This model
assumes that the levels of the factor are fixed and that the only source
of variation is the factor itself.</p>
<div class="section level4">
<h4 id="one-way-anova">One-way ANOVA<a class="anchor" aria-label="anchor" href="#one-way-anova"></a>
</h4>
<p>Here we assess only the feed effect on yield, i.e., the following
model:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi>i</mi><mi>e</mi><mi>l</mi><msub><mi>d</mi><mrow><mi>a</mi><mi>n</mi></mrow></msub><mo>=</mo><mi>Î¼</mi><mo>+</mo><mi>f</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mi>a</mi></msub><mo>+</mo><msub><mi>Ïµ</mi><mrow><mi>a</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">yield_{an} = \mu + feed_a + \epsilon_{an}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
is the feed level and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
is the observation within the feed level.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mixlm/man/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">feed</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: yield</span></span>
<span><span class="co">#&gt;           Df   Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span><span class="co">#&gt; feed       1  1755955 1755955  2.3294 0.1338</span></span>
<span><span class="co">#&gt; Residuals 46 34675246  753810</span></span></code></pre></div>
<p>In the ANOVA table one can look at Pr(&gt;F) to see if the feed
factor has a significant effect on yield. The summary function can be
used to get more information about the underlying regression model.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = yield ~ feed, data = dat)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -1904.2  -552.8  -135.1   581.1  1898.4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   7254.3      125.3  57.887   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; feed(high)    -191.3      125.3  -1.526    0.134    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; s: 868.2 on 46 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared: 0.0482,</span></span>
<span><span class="co">#&gt; Adjusted R-squared: 0.02751 </span></span>
<span><span class="co">#&gt; F-statistic: 2.329 on 1 and 46 DF,  p-value: 0.1338</span></span></code></pre></div>
<p>Basic model assessment can be done using the plot function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">old.par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, ask<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette_B_ANOVA_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">old.par</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="two-way-crossed-effects-anova">Two-way crossed effects ANOVA<a class="anchor" aria-label="anchor" href="#two-way-crossed-effects-anova"></a>
</h4>
<p>Here we assess the feed and breed effects and their interaction
effect on yield, i.e., the following model:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi>i</mi><mi>e</mi><mi>l</mi><msub><mi>d</mi><mrow><mi>a</mi><mi>b</mi><mi>n</mi></mrow></msub><mo>=</mo><mi>Î¼</mi><mo>+</mo><mi>f</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mi>a</mi></msub><mo>+</mo><mi>b</mi><mi>r</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mi>b</mi></msub><mo>+</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>f</mi><mi>e</mi><mi>e</mi><mi>d</mi><mo>:</mo><mi>b</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>+</mo><msub><mi>Ïµ</mi><mrow><mi>a</mi><mi>b</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">yield_{abn} = \mu + feed_a + breed_b + (feed:breed)_{ab} + \epsilon_{abn}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
is the feed level and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
is the observation within the feed level.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mixlm/man/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">feed</span><span class="op">*</span><span class="va">breed</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: yield</span></span>
<span><span class="co">#&gt;            Df   Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span><span class="co">#&gt; feed        1  1755955 1755955  2.1892 0.1464</span></span>
<span><span class="co">#&gt; breed       2   126874   63437  0.0791 0.9241</span></span>
<span><span class="co">#&gt; feed:breed  2   860065  430032  0.5361 0.5890</span></span>
<span><span class="co">#&gt; Residuals  42 33688307  802103</span></span></code></pre></div>
<p>If the interaction effect is not significant, we can simplify the
model to:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi>i</mi><mi>e</mi><mi>l</mi><msub><mi>d</mi><mrow><mi>a</mi><mi>b</mi><mi>n</mi></mrow></msub><mo>=</mo><mi>Î¼</mi><mo>+</mo><mi>f</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mi>a</mi></msub><mo>+</mo><mi>b</mi><mi>r</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mi>b</mi></msub><mo>+</mo><msub><mi>Ïµ</mi><mrow><mi>a</mi><mi>b</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">yield_{abn} = \mu + feed_a + breed_b + \epsilon_{abn}</annotation></semantics></math></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mixlm/man/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">feed</span><span class="op">+</span><span class="va">breed</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: yield</span></span>
<span><span class="co">#&gt;           Df   Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span><span class="co">#&gt; feed       1  1755955 1755955  2.2363 0.1419</span></span>
<span><span class="co">#&gt; breed      2   126874   63437  0.0808 0.9225</span></span>
<span><span class="co">#&gt; Residuals 44 34548372  785190</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="types-of-sums-of-squares">Types of sums of squares<a class="anchor" aria-label="anchor" href="#types-of-sums-of-squares"></a>
</h4>
<p>The classical way of defining sums of squares are Type I, Type II,
and Type III, as described in the documentation of the Anova() function
in the car package.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Type I - Sequential testing, including one and one effect</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: yield</span></span>
<span><span class="co">#&gt;           Df   Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span><span class="co">#&gt; feed       1  1755955 1755955  2.2363 0.1419</span></span>
<span><span class="co">#&gt; breed      2   126874   63437  0.0808 0.9225</span></span>
<span><span class="co">#&gt; Residuals 44 34548372  785190</span></span>
<span></span>
<span><span class="co"># Type II - Testing each term after all others, </span></span>
<span><span class="co"># except ignoring the term's higher-order relatives</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">mod</span>, type<span class="op">=</span><span class="st">"II"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Anova Table (Type II tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: yield</span></span>
<span><span class="co">#&gt;             Sum Sq Df F value Pr(&gt;F)</span></span>
<span><span class="co">#&gt; feed       1755955  1  2.2363 0.1419</span></span>
<span><span class="co">#&gt; breed       126874  2  0.0808 0.9225</span></span>
<span><span class="co">#&gt; Residuals 34548372 44</span></span>
<span></span>
<span><span class="co"># Type III - Testing each term after all others,</span></span>
<span><span class="co"># including the term's higher-order relatives</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">mod</span>, type<span class="op">=</span><span class="st">"III"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Anova Table (Type III tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: yield</span></span>
<span><span class="co">#&gt;                 Sum Sq Df   F value Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; (Intercept) 2525982362  1 3217.0322 &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; feed           1755955  1    2.2363 0.1419    </span></span>
<span><span class="co">#&gt; breed           126874  2    0.0808 0.9225    </span></span>
<span><span class="co">#&gt; Residuals     34548372 44                     </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>For the two-way ANOVA model, the Type I and Type II sums of squares
are the same, while Type III differs. With balanced data, this only
happens when the contrast coding is of the treatment/reference type.</p>
</div>
<div class="section level4">
<h4 id="contrast-codings">Contrast codings<a class="anchor" aria-label="anchor" href="#contrast-codings"></a>
</h4>
<p>The contrast coding can be specified for each factor in the model.
The default is reference coding, but other codings can be specified
using the <code>contrasts</code> Since we are running lm() through the
mixlm package, we can use the <code>contrasts</code> argument to specify
the coding for all effects simultaneously.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sum-coding, i.e., the sum of all levels is zero and all effects</span></span>
<span><span class="co"># are orthogonal in the balanced case.</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mixlm/man/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">feed</span><span class="op">*</span><span class="va">breed</span>, data <span class="op">=</span> <span class="va">dat</span>, contrasts<span class="op">=</span><span class="st">"contr.sum"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">mod</span>, type<span class="op">=</span><span class="st">"III"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Anova Table (Type III tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: yield</span></span>
<span><span class="co">#&gt;                 Sum Sq Df   F value Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; (Intercept) 2525982362  1 3149.2013 &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; feed           1755955  1    2.1892 0.1464    </span></span>
<span><span class="co">#&gt; breed           126874  2    0.0791 0.9241    </span></span>
<span><span class="co">#&gt; feed:breed      860065  2    0.5361 0.5890    </span></span>
<span><span class="co">#&gt; Residuals     33688307 42                     </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span></span>
<span><span class="co"># Weighted coding, i.e., the sum of all levels is zero and the effects</span></span>
<span><span class="co"># are weighted by the number of levels, effect-wise.</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mixlm/man/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">feed</span><span class="op">*</span><span class="va">breed</span>, data <span class="op">=</span> <span class="va">dat</span>, contrasts<span class="op">=</span><span class="st">"contr.weighted"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">mod</span>, type<span class="op">=</span><span class="st">"III"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Anova Table (Type III tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: yield</span></span>
<span><span class="co">#&gt;                 Sum Sq Df   F value Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; (Intercept) 2525982362  1 3149.2013 &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; feed           1755955  1    2.1892 0.1464    </span></span>
<span><span class="co">#&gt; breed           126874  2    0.0791 0.9241    </span></span>
<span><span class="co">#&gt; feed:breed      860065  2    0.5361 0.5890    </span></span>
<span><span class="co">#&gt; Residuals     33688307 42                     </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>Instead of specifying the contrasts in a specific model, it is also
possible to set the contrasts globally for the session. This means that
all subsequent models, unless specified otherwise, will use the
specified contrasts.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>contrasts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"contr.sum"</span>, <span class="st">"contr.poly"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="covariates-in-anova">Covariates in ANOVA<a class="anchor" aria-label="anchor" href="#covariates-in-anova"></a>
</h4>
<p>Adding covariates to an ANOVA model is straightforward. Here we add
the age of the cow as a covariate to the two-way ANOVA model. The model
becomes:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi>i</mi><mi>e</mi><mi>l</mi><msub><mi>d</mi><mrow><mi>a</mi><mi>b</mi><mi>n</mi></mrow></msub><mo>=</mo><mi>Î¼</mi><mo>+</mo><mi>f</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mi>a</mi></msub><mo>+</mo><mi>b</mi><mi>r</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mi>b</mi></msub><mo>+</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>f</mi><mi>e</mi><mi>e</mi><mi>d</mi><mo>:</mo><mi>b</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>+</mo><mi>a</mi><mi>g</mi><mi>e</mi><mo>â‹…</mo><msub><mi>x</mi><mrow><mi>a</mi><mi>b</mi><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>Ïµ</mi><mrow><mi>a</mi><mi>b</mi><mi>n</mi></mrow></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">yield_{abn} = \mu + feed_a + breed_b + (feed:breed)_{ab} + age\cdot x_{abn} + \epsilon_{abn},</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mrow><mi>a</mi><mi>b</mi><mi>n</mi></mrow></msub><annotation encoding="application/x-tex">x_{abn}</annotation></semantics></math>
is the age of the cow and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>g</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">age</annotation></semantics></math>
is its linear coefficient.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mixlm/man/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">feed</span><span class="op">*</span><span class="va">breed</span> <span class="op">+</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">mod</span>, type<span class="op">=</span><span class="st">"II"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Anova Table (Type II tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: yield</span></span>
<span><span class="co">#&gt;              Sum Sq Df F value    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; feed        1718601  1  2.9288 0.0945692 .  </span></span>
<span><span class="co">#&gt; breed         13015  2  0.0111 0.9889747    </span></span>
<span><span class="co">#&gt; age         9629682  1 16.4106 0.0002214 ***</span></span>
<span><span class="co">#&gt; feed:breed   793690  2  0.6763 0.5140804    </span></span>
<span><span class="co">#&gt; Residuals  24058625 41                      </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="fixed-effect-nested-anova">Fixed effect nested ANOVA<a class="anchor" aria-label="anchor" href="#fixed-effect-nested-anova"></a>
</h4>
<p>In the case of nested factors, we can specify this in the model. In
the current model, we assume that bulls are fixed effects that we are
interested in and that daughters are nested under bulls. In this case,
the daughters do not have any special attributes that would interfere
with the estimation of the bull effect, so we do not have to assume that
they are random effects. The model becomes:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi>i</mi><mi>e</mi><mi>l</mi><msub><mi>d</mi><mrow><mi>a</mi><mi>b</mi><mi>n</mi></mrow></msub><mo>=</mo><mi>Î¼</mi><mo>+</mo><mi>b</mi><mi>u</mi><mi>l</mi><msub><mi>l</mi><mi>a</mi></msub><mo>+</mo><mi>d</mi><mi>a</mi><mi>u</mi><mi>g</mi><mi>t</mi><mi>e</mi><msub><mi>r</mi><mrow><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mo>+</mo><msub><mi>Ïµ</mi><mrow><mi>a</mi><mi>b</mi><mi>n</mi></mrow></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">yield_{abn} = \mu + bull_a + daugter_{b(a)} + \epsilon_{abn},</annotation></semantics></math></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mixlm/man/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">bull</span> <span class="op">+</span> <span class="va">daughter</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="va">bull</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">mod</span>, type<span class="op">=</span><span class="st">"II"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Note: model has aliased coefficients</span></span>
<span><span class="co">#&gt;       sums of squares computed by model comparison</span></span>
<span><span class="co">#&gt; Anova Table (Type II tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: yield</span></span>
<span><span class="co">#&gt;                 Sum Sq Df F value Pr(&gt;F)</span></span>
<span><span class="co">#&gt; bull           2130879  3  0.8630 0.4703</span></span>
<span><span class="co">#&gt; bull:daughter  7961749 12  0.8061 0.6421</span></span>
<span><span class="co">#&gt; Residuals     26338573 32</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="linear-mixed-models">Linear mixed models<a class="anchor" aria-label="anchor" href="#linear-mixed-models"></a>
</h3>
<p>Adding random effects to a model can be done either using least
squares modelling through the mixlm package or using ML/REML estimation
through the lme4 package (or similar).</p>
<div class="section level4">
<h4 id="classical---mixlm">Classical - mixlm<a class="anchor" aria-label="anchor" href="#classical---mixlm"></a>
</h4>
<p>Using the mixlm package, we specify the random effects using the
<code>r()</code> function. If we assume that the bull is a random
selection from the population of bulls, we can specify this as a random
effect when focusing on feed. The model looks like a fixed effect model,
but the error structure is different:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi>i</mi><mi>e</mi><mi>l</mi><msub><mi>d</mi><mrow><mi>a</mi><mi>b</mi><mi>n</mi></mrow></msub><mo>=</mo><mi>Î¼</mi><mo>+</mo><mi>f</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mi>a</mi></msub><mo>+</mo><mi>b</mi><mi>u</mi><mi>l</mi><msub><mi>l</mi><mi>b</mi></msub><mo>+</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>f</mi><mi>e</mi><mi>e</mi><mi>d</mi><mo>:</mo><mi>b</mi><mi>u</mi><mi>l</mi><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>+</mo><msub><mi>Ïµ</mi><mrow><mi>a</mi><mi>b</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">yield_{abn} = \mu + feed_a + bull_b + (feed:bull)_{ab} + \epsilon_{abn}</annotation></semantics></math></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mixlm/man/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">feed</span><span class="op">*</span><span class="fu">r</span><span class="op">(</span><span class="va">bull</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">mod</span>, type<span class="op">=</span><span class="st">"II"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of variance (unrestricted model)</span></span>
<span><span class="co">#&gt; Response: yield</span></span>
<span><span class="co">#&gt;              Mean Sq      Sum Sq Df F value Pr(&gt;F)</span></span>
<span><span class="co">#&gt; feed      1755954.98  1755954.98  1    8.20 0.0644</span></span>
<span><span class="co">#&gt; bull       710292.91  2130878.72  3    3.32 0.1755</span></span>
<span><span class="co">#&gt; feed:bull  214160.94   642482.83  3    0.27 0.8477</span></span>
<span><span class="co">#&gt; Residuals  797547.10 31901884.17 40       -      -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             Err.term(s) Err.df VC(SS)</span></span>
<span><span class="co">#&gt; 1 feed              (3)      3  fixed</span></span>
<span><span class="co">#&gt; 2 bull              (3)      3  41344</span></span>
<span><span class="co">#&gt; 3 feed:bull         (4)     40 -97231</span></span>
<span><span class="co">#&gt; 4 Residuals           -      - 797547</span></span>
<span><span class="co">#&gt; (VC = variance component)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           Expected mean squares</span></span>
<span><span class="co">#&gt; feed      (4) + 6 (3) + 24 Q[1]</span></span>
<span><span class="co">#&gt; bull      (4) + 6 (3) + 12 (2) </span></span>
<span><span class="co">#&gt; feed:bull (4) + 6 (3)          </span></span>
<span><span class="co">#&gt; Residuals (4)</span></span></code></pre></div>
<p>In addition to the ordinary ANOVA table, an overview of variance
components and expected mean squares are printed.</p>
</div>
<div class="section level4">
<h4 id="restrictions">Restrictions<a class="anchor" aria-label="anchor" href="#restrictions"></a>
</h4>
<p>The mixlm package has unrestricted models as default, but it is
possible to turn on restriction.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mixlm/man/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">feed</span><span class="op">*</span><span class="fu">r</span><span class="op">(</span><span class="va">bull</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">dat</span>, unrestricted <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">mod</span>, type<span class="op">=</span><span class="st">"II"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of variance (restricted model)</span></span>
<span><span class="co">#&gt; Response: yield</span></span>
<span><span class="co">#&gt;              Mean Sq      Sum Sq Df F value Pr(&gt;F)</span></span>
<span><span class="co">#&gt; feed      1755954.98  1755954.98  1    8.20 0.0644</span></span>
<span><span class="co">#&gt; bull       710292.91  2130878.72  3    0.89 0.4543</span></span>
<span><span class="co">#&gt; feed:bull  214160.94   642482.83  3    0.27 0.8477</span></span>
<span><span class="co">#&gt; Residuals  797547.10 31901884.17 40       -      -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             Err.term(s) Err.df VC(SS)</span></span>
<span><span class="co">#&gt; 1 feed              (3)      3  fixed</span></span>
<span><span class="co">#&gt; 2 bull              (4)     40  -7271</span></span>
<span><span class="co">#&gt; 3 feed:bull         (4)     40 -97231</span></span>
<span><span class="co">#&gt; 4 Residuals           -      - 797547</span></span>
<span><span class="co">#&gt; (VC = variance component)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           Expected mean squares</span></span>
<span><span class="co">#&gt; feed      (4) + 6 (3) + 24 Q[1]</span></span>
<span><span class="co">#&gt; bull      (4) + 12 (2)         </span></span>
<span><span class="co">#&gt; feed:bull (4) + 6 (3)          </span></span>
<span><span class="co">#&gt; Residuals (4)</span></span></code></pre></div>
<p>This effects which tests are performed and how the variance
components are estimated.</p>
</div>
<div class="section level4">
<h4 id="repeated-measures">Repeated Measures<a class="anchor" aria-label="anchor" href="#repeated-measures"></a>
</h4>
<p>A repeated measures model can be a mixed model with a random effect
for the repeated measures, where the repeated measures are nested under
the subjects. Longitudinal data is a common example of repeated measures
data, where the replicates are repetitions over time within subject. If
we subset the simulated data, we can add a longitudinal effect to the
model, in this case a random variation over three time-points. The time
effect does not necessarily need to be random.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">long</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">9</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"feed"</span>, <span class="st">"daughter"</span>, <span class="st">"yield"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">long</span>, <span class="va">long</span>, <span class="va">long</span><span class="op">)</span></span>
<span><span class="va">long</span><span class="op">$</span><span class="va">daughter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">long</span><span class="op">$</span><span class="va">daughter</span><span class="op">)</span> <span class="co"># Remove redundant daughter</span></span>
<span><span class="va">long</span><span class="op">$</span><span class="va">time</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, each<span class="op">=</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">long</span><span class="op">$</span><span class="va">yield</span> <span class="op">&lt;-</span> <span class="va">long</span><span class="op">$</span><span class="va">yield</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">24</span>, sd <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">200</span>,<span class="fl">0</span>,<span class="fl">200</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">yield</span><span class="op">~</span><span class="va">daughter</span>, data<span class="op">=</span><span class="va">long</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette_B_ANOVA_files/figure-html/unnamed-chunk-15-1.png" width="576"></p>
<p>Now we have a feed effect, individuals (daughters), and a time effect
repeated inside daughters, with the model:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi>i</mi><mi>e</mi><mi>l</mi><msub><mi>d</mi><mrow><mi>a</mi><mi>i</mi><mi>t</mi></mrow></msub><mo>=</mo><mi>Î¼</mi><mo>+</mo><mi>d</mi><mi>a</mi><mi>u</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>e</mi><msub><mi>r</mi><mi>i</mi></msub><mo>+</mo><mi>f</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mi>a</mi></msub><mo>+</mo><mi>t</mi><mi>i</mi><mi>m</mi><msub><mi>e</mi><mi>t</mi></msub><mo>+</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>f</mi><mi>e</mi><mi>e</mi><mi>d</mi><mo>:</mo><mi>t</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>a</mi><mi>t</mi></mrow></msub><mo>+</mo><msub><mi>Ïµ</mi><mrow><mi>a</mi><mi>i</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">yield_{ait} = \mu + daughter_i + feed_a + time_t + (feed:time)_{at} + \epsilon_{ait}</annotation></semantics></math></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mixlm/man/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="fu">r</span><span class="op">(</span><span class="va">daughter</span><span class="op">)</span> <span class="op">+</span> <span class="va">feed</span><span class="op">*</span><span class="fu">r</span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">long</span>, unrestricted<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">mod</span>, type<span class="op">=</span><span class="st">"II"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of variance (restricted model)</span></span>
<span><span class="co">#&gt; Response: yield</span></span>
<span><span class="co">#&gt;              Mean Sq     Sum Sq Df F value Pr(&gt;F)</span></span>
<span><span class="co">#&gt; daughter  1085642.42 3256927.25  3   1.854 0.1808</span></span>
<span><span class="co">#&gt; feed        21759.92   21759.92  1   7.079 0.1170</span></span>
<span><span class="co">#&gt; time       213465.79  426931.58  2   0.365 0.7005</span></span>
<span><span class="co">#&gt; feed:time    3073.71    6147.41  2   0.005 0.9948</span></span>
<span><span class="co">#&gt; Residuals  585554.07 8783311.09 15       -      -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             Err.term(s) Err.df  VC(SS)</span></span>
<span><span class="co">#&gt; 1 daughter          (5)     15   83348</span></span>
<span><span class="co">#&gt; 2 feed              (4)      2   fixed</span></span>
<span><span class="co">#&gt; 3 time              (5)     15  -46511</span></span>
<span><span class="co">#&gt; 4 feed:time         (5)     15 -145620</span></span>
<span><span class="co">#&gt; 5 Residuals           -      -  585554</span></span>
<span><span class="co">#&gt; (VC = variance component)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           Expected mean squares</span></span>
<span><span class="co">#&gt; daughter  (5) + 6 (1)          </span></span>
<span><span class="co">#&gt; feed      (5) + 4 (4) + 12 Q[2]</span></span>
<span><span class="co">#&gt; time      (5) + 8 (3)          </span></span>
<span><span class="co">#&gt; feed:time (5) + 4 (4)          </span></span>
<span><span class="co">#&gt; Residuals (5)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="reml">REML<a class="anchor" aria-label="anchor" href="#reml"></a>
</h4>
<p>REML estimation can be done directly with the lme4 package, but we
can also do this through the mixlm package, leveraging the r()
function.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mixlm/man/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">feed</span><span class="op">*</span><span class="fu">r</span><span class="op">(</span><span class="va">bull</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">dat</span>, REML <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">mod</span>, type<span class="op">=</span><span class="st">"III"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Deviance Table (Type III Wald chisquare tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: yield</span></span>
<span><span class="co">#&gt;                 Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">#&gt; (Intercept) 3350.9550  1     &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; feed           2.3294  1     0.1269    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>To see how mixlm transforms the model to lme4, we can print the
model.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">#&gt; Formula: yield ~ feed + (1 | bull) + (1 | feed:bull)</span></span>
<span><span class="co">#&gt;    Data: dat</span></span>
<span><span class="co">#&gt; REML criterion at convergence: 760.7979</span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups    Name        Std.Dev.</span></span>
<span><span class="co">#&gt;  feed:bull (Intercept)   0.0   </span></span>
<span><span class="co">#&gt;  bull      (Intercept)   0.0   </span></span>
<span><span class="co">#&gt;  Residual              868.2   </span></span>
<span><span class="co">#&gt; Number of obs: 48, groups:  feed:bull, 8; bull, 4</span></span>
<span><span class="co">#&gt; Fixed Effects:</span></span>
<span><span class="co">#&gt; (Intercept)        feed1  </span></span>
<span><span class="co">#&gt;      7254.3       -191.3  </span></span>
<span><span class="co">#&gt; optimizer (nloptwrap) convergence code: 0 (OK) ; 0 optimizer warnings; 1 lme4 warnings</span></span></code></pre></div>
<p>We observe that (1 | bull) and (1 | <a href="feed:bull" class="uri">feed:bull</a>) are added to the model, which means that
random intercepts are added for both bull and the interaction.</p>
</div>
</div>
<div class="section level3">
<h3 id="multivariate-anova-manova">Multivariate ANOVA (MANOVA)<a class="anchor" aria-label="anchor" href="#multivariate-anova-manova"></a>
</h3>
<p>Basic multivariate ANOVA can be done using the lm() function, if we
create a matrix of responses. In this case, we add a mastitis effect to
the model.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span><span class="op">$</span><span class="va">mastitis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">breed</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">feed</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">48</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>The model becomes:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">[</mo><mi>y</mi><mi>i</mi><mi>e</mi><mi>l</mi><msub><mi>d</mi><mrow><mi>a</mi><mi>b</mi><mi>n</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><mi>m</mi><mi>a</mi><mi>s</mi><mi>t</mi><mi>i</mi><mi>t</mi><mi>i</mi><msub><mi>s</mi><mrow><mi>a</mi><mi>b</mi><mi>n</mi></mrow></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>Î¼</mi><mo>+</mo><mi>f</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mi>a</mi></msub><mo>+</mo><mi>b</mi><mi>r</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mi>b</mi></msub><mo>+</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>f</mi><mi>e</mi><mi>e</mi><mi>d</mi><mo>:</mo><mi>b</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>+</mo><msub><mi>Ïµ</mi><mrow><mi>a</mi><mi>b</mi><mi>n</mi></mrow></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">[yield_{abn} | mastitis_{abn}] = \mu + feed_a + breed_b + (feed:breed)_{ab} + \epsilon_{abn},</annotation></semantics></math>
where each of the model terms now are vectors matching the number of
responses.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mixlm/man/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">yield</span>,<span class="va">mastitis</span><span class="op">)</span> <span class="op">~</span> <span class="va">feed</span><span class="op">*</span><span class="va">breed</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">mod</span>, type<span class="op">=</span><span class="st">"II"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Pillai test statistic</span></span>
<span><span class="co">#&gt;            Df test stat approx F num Df den Df   Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; feed        1   0.16426   4.0292      2     41 0.025260 *  </span></span>
<span><span class="co">#&gt; breed       2   0.47415   6.5256      4     84 0.000127 ***</span></span>
<span><span class="co">#&gt; feed:breed  2   0.14929   1.6939      4     84 0.159025    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>The test statistics are joint for all responses, here in the form of
the default Pillaiâ€™s test statistics. Other statistics can be produced
as follows:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">mod</span>, type<span class="op">=</span><span class="st">"II"</span>, test<span class="op">=</span><span class="st">"Wilks"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Wilks test statistic</span></span>
<span><span class="co">#&gt;            Df test stat approx F num Df den Df   Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; feed        1   0.83574   4.0292      2     41  0.02526 *  </span></span>
<span><span class="co">#&gt; breed       2   0.52761   7.7226      4     82 2.48e-05 ***</span></span>
<span><span class="co">#&gt; feed:breed  2   0.85375   1.6865      4     82  0.16100    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">mod</span>, type<span class="op">=</span><span class="st">"II"</span>, test<span class="op">=</span><span class="st">"Hotelling-Lawley"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Hotelling-Lawley test statistic</span></span>
<span><span class="co">#&gt;            Df test stat approx F num Df den Df    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; feed        1   0.19655   4.0292      2     41   0.02526 *  </span></span>
<span><span class="co">#&gt; breed       2   0.89201   8.9201      4     80 5.227e-06 ***</span></span>
<span><span class="co">#&gt; feed:breed  2   0.16775   1.6775      4     80   0.16336    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">mod</span>, type<span class="op">=</span><span class="st">"II"</span>, test<span class="op">=</span><span class="st">"Roy"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Roy test statistic</span></span>
<span><span class="co">#&gt;            Df test stat approx F num Df den Df    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; feed        1   0.19655   4.0292      2     41   0.02526 *  </span></span>
<span><span class="co">#&gt; breed       2   0.88826  18.6535      2     42 1.595e-06 ***</span></span>
<span><span class="co">#&gt; feed:breed  2   0.14285   2.9999      2     42   0.06056 .  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>The summary function can be used to get more information about the
underlying regression model, here revealing the regressions are
performed separately for each response.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = cbind(yield, mastitis) ~ feed * breed, data = dat)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;          yield mastitis</span></span>
<span><span class="co">#&gt; Min    -2123.5 -2.25984</span></span>
<span><span class="co">#&gt; 1Q      -506.2 -0.60241</span></span>
<span><span class="co">#&gt; Median  -109.0  0.07629</span></span>
<span><span class="co">#&gt; 3Q       625.8  0.60307</span></span>
<span><span class="co">#&gt; Max     1762.0  1.82843</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;      Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; [1,]  7254.28     129.27  56.118   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; [2,]  -191.27     129.27  -1.480    0.146    </span></span>
<span><span class="co">#&gt; [3,]    40.78     182.81   0.223    0.825    </span></span>
<span><span class="co">#&gt; [4,]   -72.52     182.81  -0.397    0.694    </span></span>
<span><span class="co">#&gt; [5,]   116.25     182.81   0.636    0.528    </span></span>
<span><span class="co">#&gt; [6,]    71.26     182.81   0.390    0.699    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; s: 895.6 on 42 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared: 0.974,</span></span>
<span><span class="co">#&gt; Adjusted R-squared: 0.971 </span></span>
<span><span class="co">#&gt; F-statistic: 315.3 on 5 and 42 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kristian Hovde Liland.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
