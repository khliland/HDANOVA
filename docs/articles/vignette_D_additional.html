<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>D. Additional methods • HDANOVA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="D. Additional methods">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HDANOVA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/vignette_A_data.html">A. Data handling</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_B_ANOVA.html">B. Analysis of Variance</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_C_ASCA.html">C. ASCA</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_D_additional.html">D. Additional methods</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/khliland/HDANOVA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>D. Additional methods</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/khliland/HDANOVA/blob/HEAD/vignettes/vignette_D_additional.Rmd" class="external-link"><code>vignettes/vignette_D_additional.Rmd</code></a></small>
      <div class="d-none name"><code>vignette_D_additional.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Start the HDANOVA R package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://khliland.github.io/HDANOVA">HDANOVA</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'HDANOVA'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     loadings</span></span></code></pre></div>
<div class="section level2">
<h2 id="additional-methods-of-hd-anova">Additional methods of HD-ANOVA<a class="anchor" aria-label="anchor" href="#additional-methods-of-hd-anova"></a>
</h2>
<p>The examples shown here are HD-ANOVA methods that share aspects with
ASCA.</p>
<ul>
<li>Principal Response Curves (PRC)</li>
<li>Permutation Based MANOVA (PERMANOVA)</li>
</ul>
<div class="section level3">
<h3 id="principal-response-curves-prc">Principal Response Curves (PRC)<a class="anchor" aria-label="anchor" href="#principal-response-curves-prc"></a>
</h3>
<p>The PRC implementation we have wrapped is from the vegan package. A
single treatment factor and a time factor are accepted together with a
response matrix. The first level of the treatment factor is used as a
reference level, effectively set to zero. As the vegan package is aimed
at community ecology, the responses are called species. In our case, the
responses are compounds from the Caldana data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load Caldana data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">caldana</span><span class="op">)</span></span>
<span></span>
<span><span class="va">prc.cal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prc.html">prc</a></span><span class="op">(</span><span class="va">compounds</span> <span class="op">~</span> <span class="va">light</span> <span class="op">*</span> <span class="va">time</span>, <span class="va">caldana</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">prc.cal</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; prc(formula = compounds ~ light * time, data = caldana) </span></span>
<span><span class="co">#&gt; Species scores:</span></span>
<span><span class="co">#&gt;                    Alanine                     Valine </span></span>
<span><span class="co">#&gt;                   0.900828                   0.175768 </span></span>
<span><span class="co">#&gt;                    Leucine                 Isoleucine </span></span>
<span><span class="co">#&gt;                  -0.657559                  -0.264687 </span></span>
<span><span class="co">#&gt;                    Proline                     Serine </span></span>
<span><span class="co">#&gt;                   1.141926                  -0.051640 </span></span>
<span><span class="co">#&gt;                  Threonine               beta-alanine </span></span>
<span><span class="co">#&gt;                   0.075174                  -0.726471 </span></span>
<span><span class="co">#&gt;             Hydroxyproline                       GABA </span></span>
<span><span class="co">#&gt;                  -0.007045                  -1.087892 </span></span>
<span><span class="co">#&gt;                  Aspartate                 Asparagine </span></span>
<span><span class="co">#&gt;                  -0.696076                  -0.338664 </span></span>
<span><span class="co">#&gt;                 Methionine            O-acetyl-serine </span></span>
<span><span class="co">#&gt;                   0.863337                   0.205739 </span></span>
<span><span class="co">#&gt;                  Glutamate              Phenylalanine </span></span>
<span><span class="co">#&gt;                  -0.337782                   1.245032 </span></span>
<span><span class="co">#&gt;                  Ornithine                  Glutamine </span></span>
<span><span class="co">#&gt;                   0.041141                   1.302687 </span></span>
<span><span class="co">#&gt;                     Lysine                   Tyrosine </span></span>
<span><span class="co">#&gt;                  -1.175389                  -0.606966 </span></span>
<span><span class="co">#&gt;              Threonic-acid        Citrulline-Arginine </span></span>
<span><span class="co">#&gt;                  -0.323093                   0.526770 </span></span>
<span><span class="co">#&gt;               Pyruvic-acid                Citric-acid </span></span>
<span><span class="co">#&gt;                   0.473488                  -0.414141 </span></span>
<span><span class="co">#&gt;              Succinic-acid               Fumaric-acid </span></span>
<span><span class="co">#&gt;                  -0.690860                   0.005060 </span></span>
<span><span class="co">#&gt;                 Malic-acid                Lactic-acid </span></span>
<span><span class="co">#&gt;                   0.006521                  -0.497413 </span></span>
<span><span class="co">#&gt;              Glycolic-acid               Benzoic-acid </span></span>
<span><span class="co">#&gt;                   1.624649                  -0.141741 </span></span>
<span><span class="co">#&gt;                Maleic-acid             Nicotinic-acid </span></span>
<span><span class="co">#&gt;                   0.767982                  -0.060987 </span></span>
<span><span class="co">#&gt;              Itaconic-acid                Citramalate </span></span>
<span><span class="co">#&gt;                  -0.169012                   0.050705 </span></span>
<span><span class="co">#&gt;     4-hydroxy-benzoic-acid Dehydroascorbic-acid-dimer </span></span>
<span><span class="co">#&gt;                  -0.191369                   0.062572 </span></span>
<span><span class="co">#&gt;              Gluconic-acid       Dehydroascorbic-acid </span></span>
<span><span class="co">#&gt;                  -0.159411                  -0.108530 </span></span>
<span><span class="co">#&gt;              Ascorbic-acid     4-Hydroxycinnamic-acid </span></span>
<span><span class="co">#&gt;                  -0.232603                  -0.133527 </span></span>
<span><span class="co">#&gt;         Similar-to-Adenine                  Shikimate </span></span>
<span><span class="co">#&gt;                   0.010357                   0.878436 </span></span>
<span><span class="co">#&gt;                 Erythritol                  Arabinose </span></span>
<span><span class="co">#&gt;                  -0.068112                  -0.110114 </span></span>
<span><span class="co">#&gt;                   Arabitol                     Fucose </span></span>
<span><span class="co">#&gt;                  -0.337455                  -0.051972 </span></span>
<span><span class="co">#&gt;                   Fructose                   Mannitol </span></span>
<span><span class="co">#&gt;                   3.606930                   0.215745 </span></span>
<span><span class="co">#&gt;                  Galactose                    Glucose </span></span>
<span><span class="co">#&gt;                   0.097331                   2.777645 </span></span>
<span><span class="co">#&gt;                    Sucrose                    Maltose </span></span>
<span><span class="co">#&gt;                   0.615215                  -0.263945 </span></span>
<span><span class="co">#&gt;                  Trehalose                 Galactinol </span></span>
<span><span class="co">#&gt;                  -0.195746                   0.211351 </span></span>
<span><span class="co">#&gt;               myo-inositol                     Uracil </span></span>
<span><span class="co">#&gt;                  -0.070161                  -1.067653 </span></span>
<span><span class="co">#&gt;                 Putrescine               Ethanolamine </span></span>
<span><span class="co">#&gt;                  -0.210320                  -0.546516 </span></span>
<span><span class="co">#&gt;                   Glycerol      Indole-3-acetonitrile </span></span>
<span><span class="co">#&gt;                  -0.146868                   0.185760 </span></span>
<span><span class="co">#&gt;               Sinapic-acid              Palmitic-acid </span></span>
<span><span class="co">#&gt;                   0.131682                  -0.267378 </span></span>
<span><span class="co">#&gt;          Octadecanoic-acid            Docosanoic-acid </span></span>
<span><span class="co">#&gt;                  -0.361142                  -0.299480 </span></span>
<span><span class="co">#&gt;         Tetracosanoic-acid          Hexacosanoic-acid </span></span>
<span><span class="co">#&gt;                   0.060571                   0.188997 </span></span>
<span><span class="co">#&gt;          Octacosanoic-acid </span></span>
<span><span class="co">#&gt;                   0.167153 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients for treatment + time:treatment interaction</span></span>
<span><span class="co">#&gt; which are contrasts to treatment Dark </span></span>
<span><span class="co">#&gt; rows are treatment, columns are time</span></span>
<span><span class="co">#&gt;                    0         5       10        20        40     80    160</span></span>
<span><span class="co">#&gt; Low Light  1.601e-15 -0.003685 -0.05458 -0.121789 -0.006526 0.1098 0.1833</span></span>
<span><span class="co">#&gt; Light      3.011e-15 -0.038250  0.10345 -0.084547  0.098440 0.2416 0.3368</span></span>
<span><span class="co">#&gt; High Light 1.620e-15 -0.010944 -0.01016  0.009301  0.312173 0.6746 0.7716</span></span></code></pre></div>
<p>The default plot for PRC is a plot of treatment + time:treatment. As
we can see in the plot, the “Dark” level is the reference level from
which the other levels are contrasted.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">prc.cal</span>, species <span class="op">=</span> <span class="cn">FALSE</span>, axis <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">4</span>, legpos <span class="op">=</span> <span class="st">"bottomright"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette_D_additional_files/figure-html/unnamed-chunk-3-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="permutation-based-manova-permanova">Permutation Based MANOVA (PERMANOVA)<a class="anchor" aria-label="anchor" href="#permutation-based-manova-permanova"></a>
</h3>
<p>The PERMANOVA implementation we have wrapped is from the vegan
package. Our wrapper takes care of the specialised formatting needed for
the inputs. By default, 999 permutations are performed for the factors,
and a standard Multivariate ANOVA is returned with permutation-based
p-values.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">permanova.cal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/permanova.html">permanova</a></span><span class="op">(</span><span class="va">compounds</span> <span class="op">~</span> <span class="va">light</span> <span class="op">*</span> <span class="va">time</span>, <span class="va">caldana</span><span class="op">)</span></span>
<span><span class="va">permanova.cal</span></span>
<span><span class="co">#&gt; Permutation test for adonis under reduced model</span></span>
<span><span class="co">#&gt; Permutation: free</span></span>
<span><span class="co">#&gt; Number of permutations: 999</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; vegan::adonis2(formula = formula, data = data)</span></span>
<span><span class="co">#&gt;           Df SumOfSqs      R2      F Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Model     27  0.79189 0.35355 2.2687  0.001 ***</span></span>
<span><span class="co">#&gt; Residual 112  1.44793 0.64645                  </span></span>
<span><span class="co">#&gt; Total    139  2.23982 1.00000                  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kristian Hovde Liland.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
